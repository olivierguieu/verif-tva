/*
	SDZcheckVatService.m
	The implementation classes and methods for the checkVatService web service.
	Generated by SudzC.com
*/

#import "SDZcheckVatService.h"
				
#import "Soap.h"
//#import "Helpers.h"	

/* Implementation of the service */
				
@implementation SDZcheckVatService

	- (id) init
	{
		if(self = [super init])
		{
			// self.serviceUrl = @"http://ec.europa.eu/taxation_customs/vies/services/checkVatService";
			// we call the Helper to fetch data from user settings
            self.serviceUrl=[Helpers getWSURL ];
             
            self.namespace = @"urn:ec.europa.eu:taxud:vies:services:checkVat:types";
			self.headers = nil;
			self.logging = NO;
		}
		return self;
	}
	
	- (id) initWithUsername: (NSString*) username andPassword: (NSString*) password {
		if(self = [super initWithUsername:username andPassword:password]) {
		}
		return self;
	}
	
	+ (SDZcheckVatService*) service {
		return [SDZcheckVatService serviceWithUsername:nil andPassword:nil];
	}
	
	+ (SDZcheckVatService*) serviceWithUsername: (NSString*) username andPassword: (NSString*) password {
		return [[[SDZcheckVatService alloc] initWithUsername:username andPassword:password] autorelease];
	}

		
	/* Returns NSString*.  */
	- (SoapRequest*) checkVat: (id <SoapDelegate>) handler countryCode: (NSString*) countryCode vatNumber: (NSString*) vatNumber
	{
		return [self checkVat: handler action: nil countryCode: countryCode vatNumber: vatNumber];
	}

	- (SoapRequest*) checkVat: (id) _target action: (SEL) _action countryCode: (NSString*) countryCode vatNumber: (NSString*) vatNumber
		{
		NSMutableArray* _params = [NSMutableArray array];
		
		[_params addObject: [[[SoapParameter alloc] initWithValue: countryCode forName: @"countryCode"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: vatNumber forName: @"vatNumber"] autorelease]];
		NSString* _envelope = [Soap createEnvelope: @"checkVat" forNamespace: self.namespace withParameters: _params withHeaders: self.headers];
    // MODIF OGU   SoapRequest* _request = [SoapRequest create: _target action: _action service: self soapAction: @"" postData: _envelope deserializeTo: @"NSString"];
            SoapRequest* _request = [SoapRequest create: _target action: _action service: self soapAction: @"" postData: _envelope deserializeTo: nil];
            [_request send];
		return _request;
	}

	/* Returns NSString*.  */
	- (SoapRequest*) checkVatApprox: (id <SoapDelegate>) handler countryCode: (NSString*) countryCode vatNumber: (NSString*) vatNumber traderName: (NSString*) traderName traderCompanyType: (NSString*) traderCompanyType traderStreet: (NSString*) traderStreet traderPostcode: (NSString*) traderPostcode traderCity: (NSString*) traderCity requesterCountryCode: (NSString*) requesterCountryCode requesterVatNumber: (NSString*) requesterVatNumber
	{
		return [self checkVatApprox: handler action: nil countryCode: countryCode vatNumber: vatNumber traderName: traderName traderCompanyType: traderCompanyType traderStreet: traderStreet traderPostcode: traderPostcode traderCity: traderCity requesterCountryCode: requesterCountryCode requesterVatNumber: requesterVatNumber];
	}

	- (SoapRequest*) checkVatApprox: (id) _target action: (SEL) _action countryCode: (NSString*) countryCode vatNumber: (NSString*) vatNumber traderName: (NSString*) traderName traderCompanyType: (NSString*) traderCompanyType traderStreet: (NSString*) traderStreet traderPostcode: (NSString*) traderPostcode traderCity: (NSString*) traderCity requesterCountryCode: (NSString*) requesterCountryCode requesterVatNumber: (NSString*) requesterVatNumber
		{
		NSMutableArray* _params = [NSMutableArray array];
		
		[_params addObject: [[[SoapParameter alloc] initWithValue: countryCode forName: @"countryCode"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: vatNumber forName: @"vatNumber"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: traderName forName: @"traderName"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: traderCompanyType forName: @"traderCompanyType"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: traderStreet forName: @"traderStreet"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: traderPostcode forName: @"traderPostcode"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: traderCity forName: @"traderCity"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: requesterCountryCode forName: @"requesterCountryCode"] autorelease]];
		[_params addObject: [[[SoapParameter alloc] initWithValue: requesterVatNumber forName: @"requesterVatNumber"] autorelease]];
		NSString* _envelope = [Soap createEnvelope: @"checkVatApprox" forNamespace: self.namespace withParameters: _params withHeaders: self.headers];
		SoapRequest* _request = [SoapRequest create: _target action: _action service: self soapAction: @"" postData: _envelope deserializeTo: @"NSString"];
		[_request send];
		return _request;
	}


@end
	